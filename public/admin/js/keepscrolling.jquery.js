!function($,t,i,e){"use strict";function n(t,i){this.element=t,this.settings=$.extend({},r,i),this._defaults=r,this._name=s,this.init()}var s="keepScrolling",r={article:null,floor:null,data:{}},l=!1,o=!1;$.extend(n.prototype,{init:function(){this.roofLine=Math.ceil(.4*t.innerHeight),this.siteFloor=$(this.settings.floor),this.addPlaceholder(),this.fetch(),this.scroller()},getArticles:function(){return $(this.element).find(this.settings.article)},getArticleAddr:function(i){var e=t.location.href,n=e.substr(0,e.lastIndexOf("/"));return n+"/"+this.settings.data[i].address+".html"},getNextArticle:function(){for(var t=this.getArticles().last(),i,e=t.data("article-id"),n=parseInt(e,10)-1,s=this.settings.data.length-1;s>=0;s--)this.settings.data[s].id===n&&(i=this.getArticleAddr(s));return{id:n,url:i}},addPlaceholder:function(){var t=i.getElementById("tmpl-placeholder");t=t.innerHTML,$(this.element).append(t)},isVisible:function(e){e instanceof jQuery&&(e=e[0]);var n=e.getBoundingClientRect();return n.bottom>0&&n.right>0&&n.left<(t.innerWidth||i.documentElement.clientWidth)&&n.top<(t.innerHeight||i.documentElement.clientHeight)},isDebounced:function(t,i,e){var n;return function(){var s=this,r=arguments,l=function(){n=null,e||t.apply(s,r)},o=e&&!n;clearTimeout(n),n=setTimeout(l,i),o&&t.apply(s,r)}},isProceed:function(){return l||o||!this.isVisible(this.siteFloor)?void 0:this.getNextArticle().id<=0?void(o=!0):!0},fetch:function(){if(this.isProceed()){var i=this.element,e=this.getArticles().last();$.ajax({url:this.getNextArticle().url,type:"GET",dataType:"html",beforeSend:function(){l=!0,$(i).addClass(function(){return"fetching"})}}).done(function(n){e.after(function(){return n?$(n).find("#"+i.id).html():void 0}),t.Prism.highlightAll()}).always(function(){l=!1,$(i).removeClass(function(){return"fetching"})})}},history:function(){t.History.enabled&&this.getArticles().each(function(i,e){var n=$(t).scrollTop(),s=Math.floor(e.offsetTop-n);if(!(s>this.roofLine)){var r=e.clientHeight-1.4*this.roofLine;if(r=Math.floor(-1*r),!(r>s)){var l=$(e).data("article-id");l=parseInt(l,10);for(var o,a=this.settings.data.length-1;a>=0;a--)this.settings.data[a].id===l&&(o=a);var h=this.getArticleAddr(o);if(t.location.href!==h){var c=this.settings.data[o].title;t.History.pushState(null,c,h)}}}}.bind(this))},scroller:function(){t.addEventListener("scroll",this.isDebounced(function(){this.fetch()},300).bind(this),!1),t.addEventListener("scroll",function(){this.history()}.bind(this),!1)}}),$.fn[s]=function(t){return this.each(function(){$.data(this,"plugin_"+s)||$.data(this,"plugin_"+s,new n(this,t))})}}(jQuery,window,document);
//# sourceMappingURL=./keepscrolling.jquery.js.map